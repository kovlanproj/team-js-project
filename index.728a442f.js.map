{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,mECAO,SAASC,EAAsBC,GAClCC,aAAaC,QAAQ,MAAOC,KAAKC,UAAUJ,G,CAGxC,SAASK,IACZ,OAAOF,KAAKG,MAAML,aAAaM,QAAQ,O,CAGpC,SAASC,EAA2BC,GACvCR,aAAaC,QAAQ,OAAQC,KAAKC,UAAUK,G,CAGzC,SAASC,IACZ,OAAOP,KAAKG,MAAML,aAAaM,QAAQ,Q,oFDmB3C,EAAAI,EAAAC,WAAU,SAEV,MAAMC,EAAcC,SAASC,cAAc,mBACvCF,GACFA,EAAYG,iBAAiB,QAASC,EAAAC,iBAExCD,EAAAE,gBAAgBH,iBAAiB,QAASC,EAAAG,iBAe1C,MAAMC,EAAM,IAAI,EAAAxB,EAAAyB,SAyEhB,SAASC,EAAkBd,GACzBY,EAAIG,gBAAgBC,EAAAH,QAAKI,gBACzBL,EAAIM,QAAQjB,KAAiCW,EAAIO,gBACjDP,EACGQ,gBACAC,MAAK,EAACC,QAAEA,EAAOC,YAAEA,MAChBP,EAAAH,QAAKI,eAAeO,UAAY,GAChCZ,EAAIa,oBACJC,EAAAb,QAAWc,MAAoB,GAAdJ,GACjBK,EAAqBN,GACrBI,EAAAb,QAAWgB,WAAW7B,EAAK,IAE5B8B,MAAMC,QAAQC,I,CAGnB,SAASC,EAAkBC,EAAUlC,GACnCY,EAAIG,gBAAgBC,EAAAH,QAAKI,gBACzBL,EAAIM,QAAQjB,KAAiCW,EAAIO,gBACjDP,EACGuB,SAASD,GACTb,MAAK,EAACC,QAAEA,EAAOC,YAAEA,MAChBP,EAAAH,QAAKI,eAAeO,UAAY,GAChCZ,EAAIa,oBACJC,EAAAb,QAAWc,MAAoB,GAAdJ,GACM,IAAnBD,EAAQc,QAcZR,EAAqBN,GACrBI,EAAAb,QAAWgB,WAAW7B,GAAQY,EAAIyB,cAdhCC,EAAAC,GAASC,OAAOC,QACd,iEACA,CACEC,SAAU,aACVC,WAAY,UACZC,aAAc,OACdC,cAAc,GAQ0B,IAE/Cf,MAAMC,QAAQC,I,CAGnB,SAASJ,EAAqBkB,GAC5BlC,EAAImC,WAAY,EAChB,MAAMC,EAAYF,EACfG,KAAIC,IACH,MAAMC,eACJA,EAAcC,YACdA,EAAWC,aACXA,EAAYC,aACZA,EAAYC,UACZA,EAASC,GACTA,GACEN,EACEO,EAAO,IAAIC,KAAKJ,GAAcK,cACpC,MAAO,gBAAgBH,wNAmC7B,SAAwBI,GACtB,MAAMC,EACJ,6DAEF,OAAOD,EACH,kCAAkCA,IAClCC,C,CArCgCC,CAAeV,yUAOMD,uIAiC3D,SAAmBY,GACjB,IAAIC,EAAW,GACf,IAAK,IAAIC,EAAI,EAAGA,EAAIF,EAAI3B,OAAQ6B,GAAK,EACnC3B,EAAA4B,GAAMC,OAAOC,MAAK,EAACZ,GAAEA,EAAEa,KAAEA,MACnBb,IAAOO,EAAIE,IACbD,EAASM,KAAKD,EAAK,IAIrBL,EAAS5B,OAAS,GACpB4B,EAASO,OAAO,EAAG,EAAG,SAExB,OAAOP,C,CA3CuDQ,CAC9BjB,GACAkB,KAAK,WAAWhB,8FACiCJ,EAAaqB,QAC9D,0GAIR,IAErBD,KAAK,IACRzD,EAAAH,QAAK8D,SAASnD,UAAYwB,EAE1BhC,EAAAH,QAAK8D,SAASpE,iBAAiB,SAASqE,IACtC,MAAMC,EAAOD,EAAME,OAAOC,QAAQ,MAClC,GAAIF,EAAM,CACR,MAAMG,EAASH,EAAKI,aAAa,YACjC,EAAAC,EAAAC,eAAcvE,EAAKoE,E,KA9JzBhE,EAAAH,QAAKuE,KAAK7E,iBAAiB,UA+B3B,SAAuBqE,GACrBA,EAAMS,iBACNzE,EAAIyB,YACJX,EAAAb,QAAWc,QACX5B,EAA2Ba,EAAIO,gBAE/B,MAAMmE,EAAcV,EAAMW,cAAcC,SAASF,YAAYG,MAC1DC,OACAC,cAEH,IAAKL,EAOH,YANAhD,EAAAC,GAASC,OAAOC,QAAQ,+BAAgC,CACtDC,SAAU,aACVC,WAAY,UACZC,aAAc,OACdC,cAAc,IAIlB,OAAOZ,EAAkBqD,GAAetE,EAAAH,QAAK+E,MAAMH,M,IAjDrDzE,EAAAH,QAAKgF,eAAetF,iBAAiB,SAoDrC,WASE,OARAK,EAAIZ,KAAO0B,EAAAb,QAAWiF,iBACtB/F,EAA2Ba,EAAIZ,MAC/B+F,OAAOC,SAAS,CACdC,IAAK,EACLC,KAAM,EACNC,SAAU,WAGa,KAArBnF,EAAAH,QAAK+E,MAAMH,MACN3E,EAAkBb,KAEpBgC,EACLrC,IACAK,I,IAjEJe,EAAAH,QAAK+E,MAAMrF,iBAAiB,SAoB5B,SAA4B6F,GAC1B9G,EAAsB8G,EAAItB,OAAOW,OAEd,KADAW,EAAItB,OAAOW,OACwB,OAA7B7F,MACvBG,EAA2B,GAC3Be,EAAkB,G,IAxBtBE,EAAAH,QAAK+E,MAAMH,MAAQ7F,IAInB,SAA8ByG,GAC5B,GAAiB,KAAbA,EAQF,OAPA/G,EAAsB0B,EAAAH,QAAK+E,MAAMH,OAEjCxD,EACErC,IACAK,KAAiCW,EAAIO,qBAEvCO,EAAAb,QAAWc,QAGbb,EAAkBb,KAAiCW,EAAIO,e,CAbzDmF,CAAqBtF,EAAAH,QAAK+E,MAAMH,QAsLhC,EAAAc,EAAAC,oBAAmBC,EAAAC,MAAMC,IACvB,GAAIA,EAAM,CACIA,EAAKC,IACjBpH,aAAaC,QAAQ,OAAQ,MAC7B,EAAAS,EAAA2G,mBACA,EAAA3G,EAAA4G,QAAO,UACP,EAAA5G,EAAA6G,kB,MAEAhF,QAAQC,IAAI,sBACZxC,aAAaC,QAAQ,OAAQ,MAC7B,EAAAS,EAAA8G,gBACA,EAAA9G,EAAA+G,aACA5G,SACGC,cAAc,mBACdC,iBAAiB,QAASC,EAAAC,gB","sources":["src/index.js","src/js/local-storage.js"],"sourcesContent":["import MovieApiService from './js/movie-service';\nimport Notiflix from 'notiflix';\nimport Pagination from 'tui-pagination';\nimport 'tui-pagination/dist/tui-pagination.min.css';\nimport pagination from './js/tui-pagination';\nimport genre from './genres.json';\nimport MovieApiService from './js/movie-service';\nimport {\n  saveInputLocalStorage,\n  savePaginationLocalStorage,\n  parseInputLocalStorege,\n  parsePaginationLocalStorage,\n} from './js/local-storage';\n\nimport { auth } from './js/firebase/auth';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport {\n  onShowAuthModal,\n  formBackdropRef,\n  onClickBackdrop,\n} from './js/auth/login-form';\nimport {\n  addAuthBtns,\n  removeAuthBtns,\n  addNav,\n  removeNav,\n  renderNav,\n  addLogOutButton,\n} from './js/auth/auth-nav';\nimport { showInfoModal } from './js/model-info-film';\nimport refs from './js/refs';\n\nrenderNav('index');\n\nconst loginBtnRef = document.querySelector('#modal-btn-auth');\nif (loginBtnRef) {\n  loginBtnRef.addEventListener('click', onShowAuthModal);\n}\nformBackdropRef.addEventListener('click', onClickBackdrop);\n\nlet filmName = '';\n\n// const refs = {\n//   paginationList: document.querySelector('.tui-pagination'),\n//   form: document.querySelector('.input__wraper'),\n//   input: document.querySelector('.header__input'),\n//   cardList: document.querySelector('.films__list'),\n//   selectedPage: document.querySelector('.tui-is-selected'),\n//   infoModal: document.querySelector('.modal-holder'),\n//   modalBtnWrap: document.querySelector('.modal-btn-wrap'),\n//   filmsContainer: document.querySelector('.loader-container'),\n// };\n\nconst api = new MovieApiService();\n\nrefs.form.addEventListener('submit', onSubmitClick);\nrefs.paginationList.addEventListener('click', onClickBtnPagination);\nrefs.input.addEventListener('input', returnPopularFilms);\nrefs.input.value = parseInputLocalStorege();\n\npopularNessesaryFilm(refs.input.value);\n\nfunction popularNessesaryFilm(inputVal) {\n  if (inputVal !== '') {\n    saveInputLocalStorage(refs.input.value);\n\n    murkupSearchMovie(\n      parseInputLocalStorege(),\n      parsePaginationLocalStorage() || api.getStartPage()\n    );\n    pagination.reset();\n    return;\n  }\n  fetchPopularFilms(parsePaginationLocalStorage() || api.getStartPage());\n  return;\n}\n\nfunction returnPopularFilms(evt) {\n  saveInputLocalStorage(evt.target.value);\n  const inputValue = evt.target.value;\n  if (inputValue === '' || parseInputLocalStorege() === null) {\n    savePaginationLocalStorage(1);\n    fetchPopularFilms(1);\n  }\n}\n\nfunction onSubmitClick(event) {\n  event.preventDefault();\n  api.resetPage();\n  pagination.reset();\n  savePaginationLocalStorage(api.getStartPage());\n\n  const searchQuery = event.currentTarget.elements.searchQuery.value\n    .trim()\n    .toLowerCase();\n\n  if (!searchQuery) {\n    Notiflix.Notify.failure('Enter the name of the movie!', {\n      position: 'center-top',\n      fontFamily: 'inherit',\n      borderRadius: '25px',\n      clickToClose: true,\n    });\n    return;\n  }\n  return murkupSearchMovie(searchQuery || refs.input.value);\n}\n\nfunction onClickBtnPagination() {\n  api.page = pagination.getCurrentPage();\n  savePaginationLocalStorage(api.page);\n  window.scrollTo({\n    top: 0,\n    left: 0,\n    behavior: 'smooth',\n  });\n\n  if (refs.input.value === '') {\n    return fetchPopularFilms(parsePaginationLocalStorage());\n  }\n  return murkupSearchMovie(\n    parseInputLocalStorege(),\n    parsePaginationLocalStorage()\n  );\n}\n\nfunction fetchPopularFilms(page) {\n  api.setContainerRef(refs.filmsContainer);\n  api.setPage(parsePaginationLocalStorage() || api.getStartPage());\n  api\n    .getMoviesList()\n    .then(({ results, total_pages }) => {\n      refs.filmsContainer.innerHTML = '';\n      api.resetContainerRef();\n      pagination.reset(total_pages * 10);\n      createFilmCardMarkup(results);\n      pagination.movePageTo(page);\n    })\n    .catch(console.log);\n}\n\nfunction murkupSearchMovie(filmName, page) {\n  api.setContainerRef(refs.filmsContainer);\n  api.setPage(parsePaginationLocalStorage() || api.getStartPage());\n  api\n    .getMovie(filmName)\n    .then(({ results, total_pages }) => {\n      refs.filmsContainer.innerHTML = '';\n      api.resetContainerRef();\n      pagination.reset(total_pages * 10);\n      if (results.length === 0) {\n        Notiflix.Notify.failure(\n          'Search result not successful. Enter the correct movie name and',\n          {\n            position: 'center-top',\n            fontFamily: 'inherit',\n            borderRadius: '25px',\n            clickToClose: true,\n          }\n        );\n\n        // searchQuery = '';\n        return;\n      }\n      createFilmCardMarkup(results);\n      pagination.movePageTo(page || api.resetPage());\n    })\n    .catch(console.log);\n}\n\nfunction createFilmCardMarkup(films) {\n  api.isLibrary = false;\n  const newMarkup = films\n    .map(film => {\n      const {\n        original_title,\n        poster_path,\n        vote_average,\n        release_date,\n        genre_ids,\n        id,\n      } = film;\n      const year = new Date(release_date).getFullYear();\n      return `<li data-id=\"${id}\" class=\"card film-card\">\n                        <div class=\"film-card__img-wrap\">\n                            <img\n                                class=\"film-card__img\"\n                                src=${fetchFilmPhoto(poster_path)}\n                                alt=\"Poster to movie\"\n                                width=\"395\"\n                                height=\"574\"\n                            />\n                        </div>\n                        <div class=\"film-card__wrap\">\n                            <h2 class=\"film-card__title\">${original_title}</h2>\n                            <div class=\"film-card__wrapper\">\n                                <span class=\"film-card__info\">${getGenres(\n                                  genre_ids\n                                ).join(', ')} | ${year}</span>\n                                <span data-film-rating class=\"film-card__rating\">${vote_average.toFixed(\n                                  2\n                                )}</span>\n                            </div>\n                        </div>\n                    </li>`;\n    })\n    .join('');\n  refs.cardList.innerHTML = newMarkup;\n\n  refs.cardList.addEventListener('click', event => {\n    const card = event.target.closest('li');\n    if (card) {\n      const cardId = card.getAttribute('data-id');\n      showInfoModal(api, cardId);\n    }\n  });\n}\n\nfunction fetchFilmPhoto(posterPath) {\n  const noPosterAvaliable =\n    'https://www.reelviews.net/resources/img/default_poster.jpg';\n\n  return posterPath\n    ? `https://image.tmdb.org/t/p/w500${posterPath}`\n    : noPosterAvaliable;\n}\n\nfunction getGenres(ids) {\n  let newArray = [];\n  for (let i = 0; i < ids.length; i += 1) {\n    genre.genres.find(({ id, name }) => {\n      if (id === ids[i]) {\n        newArray.push(name);\n      }\n    });\n  }\n  if (newArray.length > 2) {\n    newArray.splice(2, 3, 'Other');\n  }\n  return newArray;\n}\n\nonAuthStateChanged(auth, user => {\n  if (user) {\n    const uid = user.uid;\n    localStorage.setItem('auth', '1');\n    removeAuthBtns();\n    addNav('index');\n    addLogOutButton();\n  } else {\n    console.log('User is signed out');\n    localStorage.setItem('auth', '0');\n    addAuthBtns();\n    removeNav();\n    document\n      .querySelector('#modal-btn-auth')\n      .addEventListener('click', onShowAuthModal);\n  }\n  // refs.modalBtnWrap.innerHTML =\n  //   '<button type=\"button\" class=\"modal-btn js-login-modal-btn\">To add movie to list, please LogIn</button>';\n  // refs.modalBtnWrap\n  //   .querySelector('.js-login-modal-btn')\n  //   .addEventListener('click', onShowAuthModal);\n});\n\n// const api = new MovieApiService();\n\n// api.getMoviesList().then(console.log);\n// api.getMovie('bullet').then(console.log);\n// api.getMovieInfo('913290').then(console.log);\n// api.getMovieTrailers('913290').then(console.log);\n// \".read\": \"now < 1669068000000\",  // 2022-11-22\n//     \".write\": \"now < 1669068000000\",  // 2022-11-22\n","export function saveInputLocalStorage(query) {\n    localStorage.setItem('loc', JSON.stringify(query));\n}\n\nexport function parseInputLocalStorege() {\n    return JSON.parse(localStorage.getItem('loc'));\n}\n\nexport function savePaginationLocalStorage(page) {\n    localStorage.setItem('page', JSON.stringify(page));\n}\n\nexport function parsePaginationLocalStorage() {\n    return JSON.parse(localStorage.getItem('page'));\n}"],"names":["$eqUos","parcelRequire","$8125d1701b78b442$export$ce86fa2bc5652613","query","localStorage","setItem","JSON","stringify","$8125d1701b78b442$export$671398853989f808","parse","getItem","$8125d1701b78b442$export$9ef2537571af44ef","page","$8125d1701b78b442$export$d06bec4b5edfecf1","$XwkCV","renderNav","$1f0dc3b9307be026$var$loginBtnRef","document","querySelector","addEventListener","$axgPN","onShowAuthModal","formBackdropRef","onClickBackdrop","$1f0dc3b9307be026$var$api","default","$1f0dc3b9307be026$var$fetchPopularFilms","setContainerRef","$krGWQ","filmsContainer","setPage","getStartPage","getMoviesList","then","results","total_pages","innerHTML","resetContainerRef","$ksYnG","reset","$1f0dc3b9307be026$var$createFilmCardMarkup","movePageTo","catch","console","log","$1f0dc3b9307be026$var$murkupSearchMovie","filmName1","getMovie","length","resetPage","$parcel$interopDefault","$eWCmQ","Notify","failure","position","fontFamily","borderRadius","clickToClose","films","isLibrary","newMarkup","map","film","original_title","poster_path","vote_average","release_date","genre_ids","id","year","Date","getFullYear","posterPath","noPosterAvaliable","$1f0dc3b9307be026$var$fetchFilmPhoto","ids","newArray","i","$eRClg","genres","find","name","push","splice","$1f0dc3b9307be026$var$getGenres","join","toFixed","cardList","event","card","target","closest","cardId","getAttribute","$hUOkC","showInfoModal","form","preventDefault","searchQuery","currentTarget","elements","value","trim","toLowerCase","input","paginationList","getCurrentPage","window","scrollTo","top","left","behavior","evt","inputVal","$1f0dc3b9307be026$var$popularNessesaryFilm","$amyG6","onAuthStateChanged","$6kcu2","auth","user","uid","removeAuthBtns","addNav","addLogOutButton","addAuthBtns","removeNav"],"version":3,"file":"index.728a442f.js.map"}